Loading parflow-ml/latest
  Loading requirement: openmpi/gcc/4.1.0 parflow/3.9.0 gdal/3.2.1
/home/SHARED/software/anaconda3/2020.07e/lib/python3.8/site-packages/setuptools/distutils_patch.py:25: UserWarning: Distutils was imported before Setuptools. This usage is discouraged and may exhibit undesirable behaviors or errors. Please use Setuptools' objects directly or at least import Setuptools first.
  warnings.warn(
/home/qh8373/SBI_TAYLOR/sbi_taylor/scripts/05_utils/sbiutils.py:110: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return torch.tensor(y_out)
100
tensor([[ 4.8347e-03],
        [ 9.7700e-03],
        [-3.5012e-03],
        [-4.6837e-03],
        [-5.2617e-03],
        [-6.9675e-03],
        [-1.0219e-02],
        [-9.3930e-03],
        [-7.5879e-03],
        [-6.0639e-03],
        [-3.7282e-03],
        [-9.0850e-04],
        [-2.4431e-03],
        [-5.6844e-03],
        [-1.5867e-03],
        [-1.0649e-03],
        [-1.1334e-03],
        [-1.3541e-03],
        [-1.0823e-03],
        [ 2.3511e-03],
        [ 2.8511e-03],
        [ 2.2088e-03],
        [-4.3876e-03],
        [-1.5205e-03],
        [ 1.2665e-03],
        [-2.6678e-04],
        [ 3.5492e-04],
        [ 2.9071e-03],
        [ 4.7350e-03],
        [ 1.5057e-03],
        [-4.7004e-04],
        [ 3.8076e-04],
        [-5.4203e-05],
        [-5.4225e-05],
        [-5.7354e-04],
        [ 2.7014e-03],
        [ 1.6469e-03],
        [-2.7914e-03],
        [-1.3286e-03],
        [ 1.3917e-04],
        [-1.4069e-04],
        [-2.7611e-03],
        [-1.4661e-03],
        [-1.6526e-04],
        [ 6.1332e-04],
        [-7.4413e-04],
        [-1.4902e-03],
        [-4.2732e-03],
        [-8.8821e-04],
        [-8.1246e-04],
        [-7.2524e-05],
        [-1.7298e-03],
        [-1.7405e-03],
        [-7.5251e-05],
        [-1.2545e-03],
        [ 4.4397e-04],
        [-8.6740e-04],
        [-5.5289e-04],
        [-1.7325e-03],
        [ 3.2368e-04],
        [-8.1164e-04],
        [ 5.3221e-04],
        [-1.3255e-03],
        [-1.9730e-03],
        [-1.6783e-03],
        [-8.5296e-04],
        [-3.1912e-03],
        [-1.8785e-03],
        [-1.1118e-03],
        [-1.2749e-04],
        [-5.6489e-04],
        [-2.7032e-03],
        [-7.5102e-04],
        [-1.4060e-03],
        [ 3.0202e-04],
        [-1.6700e-04],
        [-9.8374e-04],
        [-2.1458e-03],
        [ 7.9271e-04],
        [-7.0988e-04],
        [-5.9646e-04],
        [-1.8538e-03],
        [ 1.3476e-04],
        [ 1.0739e-04],
        [ 1.4535e-03],
        [-2.0654e-04],
        [-3.6550e-03],
        [-4.3118e-03],
        [ 5.8410e-04],
        [-1.5956e-03],
        [-2.2536e-04],
        [-1.0088e-03],
        [-2.7034e-03],
        [ 2.0071e-03],
        [ 1.8671e-03],
        [ 6.6452e-05],
        [-9.7468e-04],
        [-1.8157e-03],
        [-5.9301e-04],
        [-1.1811e-03],
        [-1.1050e-03],
        [-3.6276e-04],
        [-1.9149e-04],
        [-1.4692e-03],
        [ 4.7512e-04],
        [-8.4849e-04],
        [-3.9452e-04],
        [-8.6573e-04],
        [-8.2626e-04],
        [-4.0673e-03],
        [-3.3476e-03],
        [-3.5274e-03],
        [-8.6085e-04],
        [-2.7713e-03],
        [-2.2423e-03],
        [-2.5549e-03],
        [-3.8622e-04],
        [-2.3280e-04],
        [-1.4017e-03],
        [-6.3204e-04],
        [ 2.4518e-03],
        [ 4.8660e-03],
        [ 6.9790e-04],
        [ 1.8162e-04],
        [-1.2810e-03],
        [-8.8248e-04],
        [-2.3517e-03],
        [-1.3510e-03],
        [-2.0007e-03],
        [-1.2554e-03],
        [-1.1531e-03],
        [-2.9944e-03],
        [-1.5946e-03],
        [-3.1414e-03],
        [-3.5004e-03],
        [-1.4969e-03],
        [-1.1779e-03],
        [-8.4180e-04],
        [-2.4835e-03],
        [-3.2149e-05],
        [ 5.6660e-04],
        [-8.2862e-04],
        [ 1.2585e-03],
        [ 1.6542e-03],
        [-4.4286e-03],
        [-1.8472e-03],
        [-2.1113e-03],
        [-1.5101e-03],
        [-2.9647e-03],
        [ 8.5783e-04],
        [-3.6523e-03],
        [-8.0228e-05],
        [-3.8715e-03],
        [-7.7913e-03],
        [-8.1679e-03],
        [-7.4386e-03],
        [-2.9827e-03],
        [ 9.3886e-04],
        [ 3.8428e-03],
        [-3.9381e-03],
        [ 1.6518e-03],
        [ 1.0564e-04],
        [ 1.8870e-03],
        [-4.7133e-04],
        [-3.0243e-03],
        [-1.2332e-03],
        [-7.2390e-04],
        [-1.1957e-03],
        [-2.1619e-03],
        [-2.1481e-03],
        [-1.0498e-03],
        [-2.7125e-03],
        [-2.7936e-03],
        [-2.0922e-03],
        [-7.4930e-05],
        [ 2.4166e-02],
        [-1.0983e-02],
        [-1.0744e-03],
        [-1.8492e-04],
        [ 7.8198e-04],
        [-1.0341e-03],
        [-2.1228e-03],
        [-2.6077e-06],
        [-4.4966e-03],
        [-3.5648e-03],
        [ 3.2542e-03],
        [ 4.5932e-03],
        [ 2.1530e-03],
        [ 2.3381e-03],
        [ 2.2133e-03],
        [ 5.3792e-04],
        [ 3.1024e-04],
        [-1.3567e-03],
        [ 4.9593e-04],
        [-2.7306e-03],
        [ 1.4421e-03],
        [ 2.3541e-02],
        [ 9.4312e-02],
        [-6.2703e-03],
        [ 6.7834e-02],
        [-9.5499e-03],
        [ 4.7173e-02],
        [ 5.5609e-02],
        [ 3.9541e-03],
        [ 2.1674e-02],
        [ 5.0417e-04],
        [-3.3058e-03],
        [ 7.4924e-02],
        [ 5.1688e-02],
        [ 7.1372e-02],
        [ 2.8331e-02],
        [ 1.9062e-01],
        [ 2.9105e-01],
        [ 2.5459e-01],
        [ 1.8115e-01],
        [ 1.5209e-01],
        [ 1.6662e-01],
        [ 2.1555e-01],
        [ 2.4677e-01],
        [ 3.4994e-01],
        [ 1.7988e-01],
        [ 2.5542e-01],
        [ 2.6288e-01],
        [ 1.9534e-01],
        [ 2.2559e-02],
        [ 3.6003e-02],
        [ 1.4464e-01],
        [ 9.7912e-02],
        [ 2.8253e-01],
        [ 4.3461e-01],
        [ 4.9517e-01],
        [ 4.8357e-01],
        [ 4.6170e-01],
        [ 6.0570e-01],
        [ 6.0018e-01],
        [ 3.8916e-01],
        [ 3.0791e-01],
        [ 1.1602e-01],
        [ 2.2356e-01],
        [ 4.1573e-01],
        [ 5.4556e-01],
        [ 7.3811e-01],
        [ 7.7875e-01],
        [ 6.9876e-01],
        [ 8.8119e-01],
        [ 8.9844e-01],
        [ 3.7417e-01],
        [ 2.8182e-01],
        [ 3.3422e-01],
        [ 2.8766e-01],
        [ 2.3135e-01],
        [ 1.7313e-01],
        [ 1.8522e-01],
        [ 1.7436e-01],
        [ 1.5653e-01],
        [ 1.8441e-01],
        [ 2.4768e-01],
        [ 3.1445e-01],
        [ 6.0261e-01],
        [ 6.0083e-01],
        [ 1.8587e-01],
        [ 2.6183e-01],
        [ 6.9614e-02],
        [ 1.1604e-01],
        [ 1.0174e-01],
        [ 8.9859e-02],
        [ 9.3881e-02],
        [ 9.5805e-02],
        [ 9.2192e-02],
        [ 6.9335e-02],
        [ 6.1956e-02],
        [ 3.9662e-02],
        [ 3.7541e-02],
        [ 3.4419e-02],
        [ 2.9292e-02],
        [ 2.3059e-02],
        [ 2.7841e-02],
        [ 2.8437e-02],
        [ 2.5373e-02],
        [ 1.3943e-02],
        [ 1.4521e-02],
        [ 1.3911e-02],
        [ 1.3422e-02],
        [ 1.1999e-02],
        [ 7.3574e-03],
        [ 5.2392e-03],
        [ 5.7749e-03],
        [ 2.9529e-03],
        [ 5.7905e-03],
        [ 4.4656e-03],
        [ 5.6825e-03],
        [-3.1463e-03],
        [-4.3054e-04],
        [-2.7856e-03],
        [ 8.8257e-04],
        [ 3.4805e-04],
        [-3.2411e-03],
        [-3.6392e-03],
        [ 3.1129e-05],
        [-6.6248e-03],
        [-3.7145e-03],
        [-2.8306e-03],
        [-7.7250e-03],
        [-8.5205e-03],
        [-4.5880e-03],
        [-3.2541e-03],
        [-2.6703e-03],
        [ 5.3909e-04],
        [-1.7838e-03],
        [ 7.2069e-03],
        [ 1.2252e-02],
        [ 8.3892e-03],
        [ 1.1574e-02],
        [ 1.3573e-02],
        [ 1.0201e-02],
        [ 8.2079e-03],
        [ 4.5233e-03],
        [ 1.4813e-02],
        [ 9.6990e-03],
        [ 1.3175e-02],
        [ 8.7623e-03],
        [ 3.6971e-03],
        [ 2.4677e-03],
        [ 5.6690e-03],
        [ 4.3744e-03],
        [-1.1553e-03],
        [ 2.6711e-03],
        [ 5.6228e-03],
        [ 9.6261e-03],
        [ 5.9450e-03],
        [-8.9037e-04],
        [-1.8297e-03],
        [-3.6155e-03],
        [-3.2835e-03],
        [-3.8586e-03],
        [-4.7995e-03],
        [-2.2979e-03],
        [-2.2925e-03],
        [ 2.3366e-04],
        [ 2.6614e-03],
        [ 2.2165e-03],
        [-1.2086e-03],
        [ 7.3825e-03],
        [-1.7169e-03],
        [ 1.7166e-03],
        [ 3.5933e-03],
        [ 1.3593e-03],
        [ 4.7794e-03],
        [ 5.6723e-03],
        [ 1.1374e-02]], grad_fn=<AddmmBackward>)
Traceback (most recent call last):
  File "lstm_sbi.py", line 337, in <module>
    posterior, end_time = buildPosterior(prior_type, prior_arg1, prior_arg2, num_dim,
  File "/home/qh8373/SBI_TAYLOR/sbi_taylor/scripts/03_sbi_lstm/sbi_build.py", line 138, in buildPosterior
    simulator_wrapper, prior = prepare_for_sbi(simulator, prior)
  File "/home/qh8373/.local/lib/python3.8/site-packages/sbi/utils/user_input_checks.py", line 501, in prepare_for_sbi
    check_sbi_inputs(simulator, prior)
  File "/home/qh8373/.local/lib/python3.8/site-packages/sbi/utils/user_input_checks.py", line 518, in check_sbi_inputs
    simulation = simulator(theta)
  File "/home/qh8373/.local/lib/python3.8/site-packages/sbi/utils/user_input_checks.py", line 434, in batch_loop_simulator
    xs = list(map(simulator, theta))
  File "/home/qh8373/.local/lib/python3.8/site-packages/sbi/utils/user_input_checks.py", line 399, in pytorch_simulator
    return torch.as_tensor(simulator(theta), dtype=float32)
  File "/home/qh8373/SBI_TAYLOR/sbi_taylor/scripts/03_sbi_lstm/sbi_build.py", line 119, in simulator
    y_o = y_o + y_o * np.random.randn(y_o.shape[0]) * f_noise
NameError: name 'np' is not defined
